<!DOCTYPE html>

<html>
	<head>
		<script src=
		"https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.7.3/socket.io.js">
		</script>
		<script src="client/js/vector.js"></script>
		<script src="client/js/particle.js"></script>
		<script src="client/js/player.js"></script>


		<style>
			html, body{
				margin: 0px;
			}

			canvas{
				display:block;
			}
		</style>
	</head>
	<body>
		<canvas id="canvas"></canvas>
		
		<script>
			var socket = io();
			var players = [];
			var context;
			
			window.onload = function(){
				var canvas = document.getElementById('canvas');
				context = canvas.getContext('2d');
				width = canvas.width = window.innerWidth;
				height = canvas.height = window.innerHeight;

				//update();
				
				socket.emit('connectPlayers', null);
				
				
				
				
				
				
				document.onkeydown = function(event){
					if(event.keyCode === 68)  //d
						socket.emit('keypress', {inputId: 'right', state: true});
					if(event.keyCode === 83)  //s
						socket.emit('keypress', {inputId: 'down', state: true});
					if(event.keyCode === 65)  //a
						socket.emit('keypress', {inputId: 'left', state: true});
					if(event.keyCode === 87)  //w
						socket.emit('keypress', {inputId: 'up', state: true});
				}

				document.onkeyup = function(event){
					if(event.keyCode === 68)  //d
						socket.emit('keypress', {inputId: 'right', state: false});
					if(event.keyCode === 83)  //s
						socket.emit('keypress', {inputId: 'down', state: false});
					if(event.keyCode === 65)  //a
						socket.emit('keypress', {inputId: 'left', state: false});
					if(event.keyCode === 87)  //w
						socket.emit('keypress', {inputId: 'up', state: false});
				}
				
			};
			
			function update(){
				context.clearRect(0, 0, width, height);
				////////////////////////////////////////////
				
				for(var i = 0; i < players.length; i++){
					//players[i].draw(context);
				}


				////////////////////////////////////////////
				//window.requestAnimationFrame(update);
			}
			
			
			
			socket.on('update', function(data){
				context.clearRect(0, 0, width, height);
				//console.log(data.length);
				for(var i = 0; i < data.length; i++){
					//var p = player.create(data[i].id);
					//p.x = data[i].x;
					//p.y = data[i].y;
					//p.color = data[i].color;
					
					context.beginPath();
					context.arc(data[i].x, data[i].y,25, 0, 2 * Math.PI, false);
					context.fillStyle = data[i].color;
					context.fill();
					context.lineWidth = 5;
					context.strokeStyle = '#003300';
					context.stroke();
					
					//players.push(p);
				}
			});
		
		</script>
	</body>
</html>